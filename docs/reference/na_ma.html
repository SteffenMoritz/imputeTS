<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Missing Value Imputation by Weighted Moving Average — na_ma • imputeTS</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Missing Value Imputation by Weighted Moving Average — na_ma" />
<meta property="og:description" content="Missing value replacement by weighted moving average.
Uses semi-adaptive window size to ensure all NAs are replaced." />
<meta property="og:image" content="https://SteffenMoritz.github.io/imputeTS/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">imputeTS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/gallery_visualizations.html">Gallery: Times Series Missing Data Visualizations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/SteffenMoritz/imputeTS/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Missing Value Imputation by Weighted Moving Average</h1>
    <small class="dont-index">Source: <a href='https://github.com/SteffenMoritz/imputeTS/blob/master/R/na_ma.R'><code>R/na_ma.R</code></a></small>
    <div class="hidden name"><code>na_ma.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Missing value replacement by weighted moving average.
Uses semi-adaptive window size to ensure all NAs are replaced.</p>
    </div>

    <pre class="usage"><span class='fu'>na_ma</span><span class='op'>(</span><span class='va'>x</span>, k <span class='op'>=</span> <span class='fl'>4</span>, weighting <span class='op'>=</span> <span class='st'>"exponential"</span>, maxgap <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>Numeric Vector (<code><a href='https://rdrr.io/r/base/vector.html'>vector</a></code>) or Time Series (<code><a href='https://rdrr.io/r/stats/ts.html'>ts</a></code>)
object in which missing values shall be replaced</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>integer width of the moving average window. Expands to both sides
of the center element e.g. k=2 means 4 observations (2 left, 2 right) are
taken into account. If all observations in the current window are NA, the
window size is automatically increased until there are at least 2 non-NA
values present.</p></td>
    </tr>
    <tr>
      <th>weighting</th>
      <td><p>Weighting to be used. Accepts the following input:</p><ul>
<li><p>"simple" - Simple Moving Average (SMA)</p></li>
<li><p>"linear" - Linear Weighted Moving Average (LWMA)</p></li>
<li><p>"exponential" - Exponential Weighted Moving Average (EWMA) (default choice)</p></li>
</ul></td>
    </tr>
    <tr>
      <th>maxgap</th>
      <td><p>Maximum number of successive NAs to still perform imputation on.
Default setting is to replace all NAs without restrictions. With this
option set, consecutive NAs runs, that are longer than 'maxgap' will
be left NA. This option mostly makes sense if you want to
treat long runs of NA afterwards separately.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Vector (<code><a href='https://rdrr.io/r/base/vector.html'>vector</a></code>) or Time Series (<code><a href='https://rdrr.io/r/stats/ts.html'>ts</a></code>)
object (dependent on given input at parameter x)</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In this function missing values get replaced by moving average
values. Moving Averages are also sometimes referred to as "moving mean",
"rolling mean", "rolling average" or "running average".</p>
<p>The mean in this implementation taken from an equal number of observations
on either side of a central value. This means for an NA value at position
<code>i</code> of a time series, the observations i-1,i+1 and i+1, i+2 (assuming
a window size of k=2) are used to calculate the mean.</p>
<p>Since it can in case of long NA gaps also occur, that all values next to the
central value are also NA, the algorithm has a semi-adaptive window size.
Whenever there are less than 2 non-NA values in the complete window available,
the window size is incrementally increased, till at least 2 non-NA values are
there. In all other cases the algorithm sticks to the pre-set window size.</p>
<p>There are options for using Simple Moving Average (SMA), Linear Weighted
Moving Average (LWMA) and Exponential Weighted Moving Average (EWMA).</p>
<p>SMA: all observations in the window are equally weighted for calculating the mean.</p>
<p>LWMA: weights decrease in arithmetical progression. The observations
directly next to a central value i, have weight 1/2, the observations
one further away (i-2,i+2) have weight 1/3, the next (i-3,i+3) have
weight 1/4, ...</p>
<p>EWMA: uses weighting factors which decrease exponentially. The observations
directly next to a central value i, have weight 1/2^1, the observations one
further away (i-2,i+2) have weight 1/2^2, the next (i-3,i+3) have weight 1/2^3, ...</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='na_interpolation.html'>na_interpolation</a></code>,
<code><a href='na_kalman.html'>na_kalman</a></code>, <code><a href='na_locf.html'>na_locf</a></code>,
<code><a href='na_mean.html'>na_mean</a></code>,
<code><a href='na_random.html'>na_random</a></code>, <code><a href='na_replace.html'>na_replace</a></code>,
<code><a href='na_seadec.html'>na_seadec</a></code>, <code><a href='na_seasplit.html'>na_seasplit</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Steffen Moritz</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Example 1: Perform imputation with simple moving average</span>
<span class='fu'>na_ma</span><span class='op'>(</span><span class='va'>tsAirgap</span>, weighting <span class='op'>=</span> <span class='st'>"simple"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;           Jan      Feb      Mar      Apr      May      Jun      Jul      Aug
#&gt; 1949 112.0000 118.0000 132.0000 129.0000 131.7143 135.0000 148.0000 148.0000
#&gt; 1950 115.0000 126.0000 141.0000 135.0000 125.0000 149.0000 170.0000 170.0000
#&gt; 1951 145.0000 150.0000 178.0000 163.0000 172.0000 178.0000 199.0000 199.0000
#&gt; 1952 171.0000 180.0000 193.0000 181.0000 183.0000 218.0000 230.0000 242.0000
#&gt; 1953 196.0000 196.0000 236.0000 235.0000 229.0000 243.0000 264.0000 272.0000
#&gt; 1954 204.0000 188.0000 235.0000 227.0000 234.0000 245.8750 302.0000 293.0000
#&gt; 1955 242.0000 233.0000 267.0000 269.0000 270.0000 315.0000 364.0000 347.0000
#&gt; 1956 284.0000 277.0000 310.5000 338.5000 351.3333 374.0000 413.0000 405.0000
#&gt; 1957 315.0000 301.0000 356.0000 348.0000 355.0000 380.3750 465.0000 467.0000
#&gt; 1958 340.0000 318.0000 375.8571 348.0000 363.0000 435.0000 491.0000 505.0000
#&gt; 1959 360.0000 342.0000 406.0000 396.0000 420.0000 472.0000 548.0000 559.0000
#&gt; 1960 417.0000 391.0000 419.0000 461.0000 494.8750 535.0000 622.0000 606.0000
#&gt;           Sep      Oct      Nov      Dec
#&gt; 1949 126.7143 119.0000 104.0000 118.0000
#&gt; 1950 147.4286 133.0000 155.1429 140.0000
#&gt; 1951 184.0000 162.0000 146.0000 166.0000
#&gt; 1952 209.0000 191.0000 172.0000 194.0000
#&gt; 1953 237.0000 211.0000 180.0000 201.0000
#&gt; 1954 259.0000 229.0000 203.0000 229.0000
#&gt; 1955 312.0000 274.0000 237.0000 278.0000
#&gt; 1956 355.0000 306.0000 271.0000 306.0000
#&gt; 1957 404.0000 347.0000 382.4286 336.0000
#&gt; 1958 404.0000 359.0000 310.0000 337.0000
#&gt; 1959 463.0000 407.0000 362.0000 434.8750
#&gt; 1960 508.0000 461.0000 390.0000 432.0000</div><div class='input'>
<span class='co'># Example 2: Perform imputation with exponential weighted moving average</span>
<span class='fu'>na_ma</span><span class='op'>(</span><span class='va'>tsAirgap</span><span class='op'>)</span>
</div><div class='output co'>#&gt;           Jan      Feb      Mar      Apr      May      Jun      Jul      Aug
#&gt; 1949 112.0000 118.0000 132.0000 129.0000 133.6552 135.0000 148.0000 148.0000
#&gt; 1950 115.0000 126.0000 141.0000 135.0000 125.0000 149.0000 170.0000 170.0000
#&gt; 1951 145.0000 150.0000 178.0000 163.0000 172.0000 178.0000 199.0000 199.0000
#&gt; 1952 171.0000 180.0000 193.0000 181.0000 183.0000 218.0000 230.0000 242.0000
#&gt; 1953 196.0000 196.0000 236.0000 235.0000 229.0000 243.0000 264.0000 272.0000
#&gt; 1954 204.0000 188.0000 235.0000 227.0000 234.0000 259.1000 302.0000 293.0000
#&gt; 1955 242.0000 233.0000 267.0000 269.0000 270.0000 315.0000 364.0000 347.0000
#&gt; 1956 284.0000 277.0000 294.7778 334.3571 369.2778 374.0000 413.0000 405.0000
#&gt; 1957 315.0000 301.0000 356.0000 348.0000 355.0000 399.6000 465.0000 467.0000
#&gt; 1958 340.0000 318.0000 350.7931 348.0000 363.0000 435.0000 491.0000 505.0000
#&gt; 1959 360.0000 342.0000 406.0000 396.0000 420.0000 472.0000 548.0000 559.0000
#&gt; 1960 417.0000 391.0000 419.0000 461.0000 501.7000 535.0000 622.0000 606.0000
#&gt;           Sep      Oct      Nov      Dec
#&gt; 1949 129.8276 119.0000 104.0000 118.0000
#&gt; 1950 152.0000 133.0000 144.3077 140.0000
#&gt; 1951 184.0000 162.0000 146.0000 166.0000
#&gt; 1952 209.0000 191.0000 172.0000 194.0000
#&gt; 1953 237.0000 211.0000 180.0000 201.0000
#&gt; 1954 259.0000 229.0000 203.0000 229.0000
#&gt; 1955 312.0000 274.0000 237.0000 278.0000
#&gt; 1956 355.0000 306.0000 271.0000 306.0000
#&gt; 1957 404.0000 347.0000 361.2069 336.0000
#&gt; 1958 404.0000 359.0000 310.0000 337.0000
#&gt; 1959 463.0000 407.0000 362.0000 406.9333
#&gt; 1960 508.0000 461.0000 390.0000 432.0000</div><div class='input'>
<span class='co'># Example 3: Perform imputation with exponential weighted moving average, window size 6</span>
<span class='fu'>na_ma</span><span class='op'>(</span><span class='va'>tsAirgap</span>, k <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>
</div><div class='output co'>#&gt;           Jan      Feb      Mar      Apr      May      Jun      Jul      Aug
#&gt; 1949 112.0000 118.0000 132.0000 129.0000 133.1597 135.0000 148.0000 148.0000
#&gt; 1950 115.0000 126.0000 141.0000 135.0000 125.0000 149.0000 170.0000 170.0000
#&gt; 1951 145.0000 150.0000 178.0000 163.0000 172.0000 178.0000 199.0000 199.0000
#&gt; 1952 171.0000 180.0000 193.0000 181.0000 183.0000 218.0000 230.0000 242.0000
#&gt; 1953 196.0000 196.0000 236.0000 235.0000 229.0000 243.0000 264.0000 272.0000
#&gt; 1954 204.0000 188.0000 235.0000 227.0000 234.0000 256.6349 302.0000 293.0000
#&gt; 1955 242.0000 233.0000 267.0000 269.0000 270.0000 315.0000 364.0000 347.0000
#&gt; 1956 284.0000 277.0000 298.0641 330.4516 362.3590 374.0000 413.0000 405.0000
#&gt; 1957 315.0000 301.0000 356.0000 348.0000 355.0000 396.9677 465.0000 467.0000
#&gt; 1958 340.0000 318.0000 354.1311 348.0000 363.0000 435.0000 491.0000 505.0000
#&gt; 1959 360.0000 342.0000 406.0000 396.0000 420.0000 472.0000 548.0000 559.0000
#&gt; 1960 417.0000 391.0000 419.0000 461.0000 499.0161 535.0000 622.0000 606.0000
#&gt;           Sep      Oct      Nov      Dec
#&gt; 1949 129.8607 119.0000 104.0000 118.0000
#&gt; 1950 151.7909 133.0000 144.8091 140.0000
#&gt; 1951 184.0000 162.0000 146.0000 166.0000
#&gt; 1952 209.0000 191.0000 172.0000 194.0000
#&gt; 1953 237.0000 211.0000 180.0000 201.0000
#&gt; 1954 259.0000 229.0000 203.0000 229.0000
#&gt; 1955 312.0000 274.0000 237.0000 278.0000
#&gt; 1956 355.0000 306.0000 271.0000 306.0000
#&gt; 1957 404.0000 347.0000 360.9500 336.0000
#&gt; 1958 404.0000 359.0000 310.0000 337.0000
#&gt; 1959 463.0000 407.0000 362.0000 410.7661
#&gt; 1960 508.0000 461.0000 390.0000 432.0000</div><div class='input'>
<span class='co'># Example 4: Same as example 1, just written with pipe operator</span>
<span class='va'>tsAirgap</span> <span class='op'>%&gt;%</span> <span class='fu'>na_ma</span><span class='op'>(</span>weighting <span class='op'>=</span> <span class='st'>"simple"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;           Jan      Feb      Mar      Apr      May      Jun      Jul      Aug
#&gt; 1949 112.0000 118.0000 132.0000 129.0000 131.7143 135.0000 148.0000 148.0000
#&gt; 1950 115.0000 126.0000 141.0000 135.0000 125.0000 149.0000 170.0000 170.0000
#&gt; 1951 145.0000 150.0000 178.0000 163.0000 172.0000 178.0000 199.0000 199.0000
#&gt; 1952 171.0000 180.0000 193.0000 181.0000 183.0000 218.0000 230.0000 242.0000
#&gt; 1953 196.0000 196.0000 236.0000 235.0000 229.0000 243.0000 264.0000 272.0000
#&gt; 1954 204.0000 188.0000 235.0000 227.0000 234.0000 245.8750 302.0000 293.0000
#&gt; 1955 242.0000 233.0000 267.0000 269.0000 270.0000 315.0000 364.0000 347.0000
#&gt; 1956 284.0000 277.0000 310.5000 338.5000 351.3333 374.0000 413.0000 405.0000
#&gt; 1957 315.0000 301.0000 356.0000 348.0000 355.0000 380.3750 465.0000 467.0000
#&gt; 1958 340.0000 318.0000 375.8571 348.0000 363.0000 435.0000 491.0000 505.0000
#&gt; 1959 360.0000 342.0000 406.0000 396.0000 420.0000 472.0000 548.0000 559.0000
#&gt; 1960 417.0000 391.0000 419.0000 461.0000 494.8750 535.0000 622.0000 606.0000
#&gt;           Sep      Oct      Nov      Dec
#&gt; 1949 126.7143 119.0000 104.0000 118.0000
#&gt; 1950 147.4286 133.0000 155.1429 140.0000
#&gt; 1951 184.0000 162.0000 146.0000 166.0000
#&gt; 1952 209.0000 191.0000 172.0000 194.0000
#&gt; 1953 237.0000 211.0000 180.0000 201.0000
#&gt; 1954 259.0000 229.0000 203.0000 229.0000
#&gt; 1955 312.0000 274.0000 237.0000 278.0000
#&gt; 1956 355.0000 306.0000 271.0000 306.0000
#&gt; 1957 404.0000 347.0000 382.4286 336.0000
#&gt; 1958 404.0000 359.0000 310.0000 337.0000
#&gt; 1959 463.0000 407.0000 362.0000 434.8750
#&gt; 1960 508.0000 461.0000 390.0000 432.0000</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steffen Moritz, Sebastian Gatscha.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


